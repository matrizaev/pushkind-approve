{% if 'selectedOptions' not in product %}
    {% set _ = glob.update({'no_measurements':True}) %}
{% endif %}
<div class="row my-1 py-1 selectable border-top border-bottom {% if product['id'] in order.user_approvals|map(attribute='product_id')|list %}border-danger{%endif%}" data-id="{{ product.id }}">
    <div class="col-auto">
        <img src="{{ product['imageUrl'] or config['PLACEHOLDER_IMAGE'] }}" height="96" width="96" alt="thumbnail">
    </div>
    <div class="col overflow-hidden">
        <h5>{{ product['name'] }}</h5>
        <small>Артикул: {{ product['sku'] }}</small>
        {% if 'selectedOptions' in product %}
            <br>
            {% for option in product['selectedOptions'][1:] %}
                <small>{{ option['value'] }}</small>
            {% endfor %}
        {% endif %}
    </div>
    <div class="col-sm-1 overflow-hidden">
        {{ product['vendor'] }}
    </div>
    <div class="col-sm-2 overflow-hidden">
        Цена: <strong>{{ '{:,.2f}'.format(product['price']) }}</strong>
        <br>
        {% if current_user.role.name == 'admin' or current_user.id == order.initiative_id %}
            <form class="changeQuantityForm" action="{{ url_for('main.SaveQuantity', order_id=order.id) }}" method="POST">
                {{ quantity_form.csrf_token(id=False) }}
                {{ quantity_form.product_id(class_='d-none', hidden='', value=product['id'], id=False) }}
                <div class="input-group my-1">
                    <span class="input-group-text" style="width: 91px;">Единицы</span>
                    <input name="product_measurement" type="text" class="form-control" aria-label="Единицы" value="{{product['selectedOptions'][0]['value']}}">
                </div>
                <div class="input-group my-1">
                    <span class="input-group-text" style="width: 91px;">Кол-во</span>
                    <input name="product_quantity" type="number" class="form-control" min="0" step="1" aria-label="Количество" value="{{product['quantity']}}">
                </div>
                {{ quantity_form.submit(id=False, class_='d-none btn btn-primary w-100 my-1 text-white') }}
            </form>
        {% else %}
            Единицы: <strong>{{product['selectedOptions'][0]['value']}}</strong>
            <br>
            Кол-во: <strong>{{product['quantity']}}</strong>
        {% endif %}
    </div>
    <div class="col-sm-2 overflow-hidden">
        {% if product['id'] in order.user_approvals|map(attribute='product_id')|list %}
            <a class="showRemarks text-danger fs-4" href="#" data-bs-toggle="modal" data-bs-target="#remarksModal" data-id="{{ product.id }}"><i class="bi bi-chat-left"></i></a>
        {% else %}
            <span class="text-white"><i class="bi bi-chat-left"></i></span>
        {% endif %}
        {% if current_user.role.name in ['validator'] %}
            <br>
            <a href="#" class="approveButton text-decoration-none" data-id="{{ product['id'] }}" data-target="product">
                +замечание
            </a>
        {% endif %}
    </div>
</div>