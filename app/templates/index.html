{% extends "base.html" %}

{% block styles %}
	<style>
		.ecwidOrder{
			cursor: pointer;
		}
	</style>
{% endblock %}

{% block content %}
<div class="container border bg-light my-1">
	<div class="row border-bottom">
		<div class="col">
		{% if filter_approval == 'new' %}
			<span class="badge badge-secondary font-weight-bold">НОВЫЕ</span>
		{% else %}
			<a href="{{ url_for('main.ShowIndex', from = filter_from, approval = 'new', location = filter_location) }}" class="badge badge-secondary">новые</a>
		{% endif %}
		{% if filter_approval == 'partly_approved' %}
			<span class="badge badge-warning font-weight-bold">В РАБОТЕ</span>
		{% else %}
			<a href="{{ url_for('main.ShowIndex', from = filter_from, approval = 'partly_approved', location = filter_location) }}" class="badge badge-warning">в работе</a>
		{% endif %}
		{% if filter_approval == 'approved' %}
			<span class="badge badge-success font-weight-bold">СОГЛАСОВАННЫЕ</span>
		{% else %}
			<a href="{{ url_for('main.ShowIndex', from = filter_from, approval = 'approved', location = filter_location) }}" class="badge badge-success">согласованные</a>
		{% endif %}
		{% if filter_approval == 'not_approved' %}
			<span class="badge badge-danger font-weight-bold">НЕ СОГЛАСОВАННЫЕ</span>
		{% else %}
			<a href="{{ url_for('main.ShowIndex', from = filter_from, approval = 'not_approved', location = filter_location) }}" class="badge badge-danger">не согласованные</a>
		{% endif %}
		{% if filter_approval == None %}
			<span class="badge badge-dark text-white font-weight-bold">ВСЕ</span>
		{% else %}
			<a href="{{ url_for('main.ShowIndex', from = filter_from, location = filter_location) }}" class="badge badge-dark text-white">все</a>
		{% endif %}
		</div>
	</div>
	<div class="row border-bottom">
		<div class="col">
			{% if filter_from == dates[0] %}
				<span class="badge badge-dark text-white font-weight-bold">СЕГОДНЯ</span>
			{% else %}
				<a href="{{ url_for('main.ShowIndex', from = dates[0], approval = filter_approval, location = filter_location) }}" class="badge badge-dark text-white">сегодня</a>
			{% endif %}
			{% if filter_from == dates[1] %}
				<span class="badge badge-dark text-white font-weight-bold">НЕДЕЛЯ</span>
			{% else %}
				<a href="{{ url_for('main.ShowIndex', from = dates[1], approval = filter_approval, location = filter_location) }}" class="badge badge-dark text-white">неделя</a>
			{% endif %}
			{% if filter_from == dates[2] %}
				<span class="badge badge-dark text-white font-weight-bold">МЕСЯЦ</span>
			{% else %}
				<a href="{{ url_for('main.ShowIndex', from = dates[2], approval = filter_approval, location = filter_location) }}" class="badge badge-dark text-white">месяц</a>
			{% endif %}
			{% if filter_from == None %}
				<span class="badge badge-dark text-white font-weight-bold">ВСЕ</span>
			{% else %}
				<a href="{{ url_for('main.ShowIndex', approval = filter_approval, location = filter_location) }}" class="badge badge-dark text-white">все</a>
			{% endif %}
		</div>
	</div>
	{% if current_user.role.name != 'initiative' %}
		<div class="row">
			<div class="col">
				{% for email, initiative in initiatives.items() %}
					<a href="{{ url_for('main.ShowIndex', approval = filter_approval, from = filter_from, location = email) }}" class="badge badge-dark text-white">
						{% if initiative.location != '' or initiative.name != '' %}
							{{ initiative.location }}<br>
							<sup class="small font-italic font-weight-light">{{ initiative.name }}</sup>
						{% else %}
							{{ email }}
						{% endif %}
					</a>
				{% endfor %}
					<a href="{{ url_for('main.ShowIndex', approval = filter_approval, from = filter_from) }}" class="badge badge-dark text-white">
						{% if initiatives| length > 1 %}
							ВСЕ
						{% else %}
							все
						{% endif %}
					</a>
			</div>
		</div>
	{% endif %}
</div>
<div class="container border bg-light my-1">
	<h6 class="text-secondary">Заявки</h6>
	<div class="row my-1 d-none d-sm-flex font-weight-bold">
		<div class="col overflow-hidden">
			Номер
		</div>
		<div class="col overflow-hidden">
			Дата
		</div>
		<div class="col overflow-hidden">
			Инициатор
		</div>
		<div class="col overflow-hidden">
			Сумма
		</div>
		<div class="col overflow-hidden">
			Согласование
		</div>
	</div>
	{% for order in orders %}
		{% include '_order.html' %}
	{% endfor %}
</div>
{% endblock %}

{% block scripts %}

<script>
	$(document).ready(function(){
		//Scripts
		
		$(".ecwidOrder").click(function(event){
			var orderId = Number($(this).attr('id').replace('order', ''));
			if (!isNaN(orderId))
				document.location.href = '/order/' + orderId;
		});
	});
</script>
{%endblock %}