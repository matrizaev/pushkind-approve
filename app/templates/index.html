{% extends "base.html" %}

{% block styles %}
	<style>
		.ecwidOrder{
			cursor: pointer;
		}
	</style>
{% endblock %}

{% block content %}
<div class="container border bg-light my-1">
	<div class="row border-bottom">
		<div class="col">
		{% for status in OrderStatus %}
			<a href="{{ url_for('main.ShowIndex', from = filter_from, approval = status.name, location = filter_location) }}" class="badge badge-{{status.color()}} {%if filter_approval == status.name %}text-uppercase{%endif%}">{{ status }}</a>
		{% endfor %}
			<a href="{{ url_for('main.ShowIndex', from = filter_from, location = filter_location) }}" class="badge badge-dark {%if not filter_approval %}text-uppercase{%endif%}">все</a>
		</div>
	</div>
	<div class="row border-bottom">
		<div class="col">
			{% if filter_from == dates[0] %}
				<span class="badge badge-dark text-white font-weight-bold">СЕГОДНЯ</span>
			{% else %}
				<a href="{{ url_for('main.ShowIndex', from = dates[0], approval = filter_approval, location = filter_location) }}" class="badge badge-dark text-white">сегодня</a>
			{% endif %}
			{% if filter_from == dates[1] %}
				<span class="badge badge-dark text-white font-weight-bold">НЕДЕЛЯ</span>
			{% else %}
				<a href="{{ url_for('main.ShowIndex', from = dates[1], approval = filter_approval, location = filter_location) }}" class="badge badge-dark text-white">неделя</a>
			{% endif %}
			{% if filter_from == dates[2] %}
				<span class="badge badge-dark text-white font-weight-bold">МЕСЯЦ</span>
			{% else %}
				<a href="{{ url_for('main.ShowIndex', from = dates[2], approval = filter_approval, location = filter_location) }}" class="badge badge-dark text-white">месяц</a>
			{% endif %}
			{% if filter_from == None %}
				<span class="badge badge-dark text-white font-weight-bold">ВСЕ</span>
			{% else %}
				<a href="{{ url_for('main.ShowIndex', approval = filter_approval, location = filter_location) }}" class="badge badge-dark text-white">все</a>
			{% endif %}
		</div>
	</div>
	{% if current_user.role.name != 'initiative' %}
		<div class="row">
			<div class="col">
				{% for location in locations %}
					<a href="{{ url_for('main.ShowIndex', approval = filter_approval, from = filter_from, location = location) }}" class="badge badge-dark text-white">
						{{ location }}
					</a>
				{% endfor %}
					<a href="{{ url_for('main.ShowIndex', approval = filter_approval, from = filter_from) }}" class="badge badge-dark text-white">
						все
					</a>
			</div>
		</div>
	{% endif %}
</div>
<div class="container border bg-light my-1">
	<h6 class="border-bottom border-gray pb-2 mb-0">Заявки</h6>
	<div class="row my-1">
		<div class="col">
			<input class="form-control" id="orderFilter" type="text" placeholder="Фильтр..">
		</div>
	</div>
	<div class="row my-1 d-none d-sm-flex font-weight-bold px-3">
		<div class="col overflow-hidden">
			Номер
		</div>
		<div class="col overflow-hidden">
			Дата
		</div>
		<div class="col overflow-hidden">
			Инициатор
		</div>
		<div class="col overflow-hidden">
			Сумма
		</div>
		<div class="col overflow-hidden">
			Статус
		</div>
	</div>
	{% for order in orders %}
		{% include '_order.html' %}
	{% endfor %}
</div>
{% endblock %}

{% block scripts %}

<script>
	$(document).ready(function(){
	
		$("#orderFilter").on("keyup", function() {
			var value = $(this).val().toLowerCase();
			$(".ecwidOrder").filter(function() {
				$(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
			});
		});
		
		$(".ecwidOrder").click(function(event){
			var orderId = Number($(this).attr('id').replace('order', ''));
			if (!isNaN(orderId))
				document.location.href = '/order/' + orderId;
		});
	});
</script>
{%endblock %}