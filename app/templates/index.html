{% extends "base.html" %}

{% block styles %}
	<style>
		.ecwidOrder{
			cursor: pointer;
		}
	</style>
{% endblock %}

{% block content %}
<div class="container border bg-light my-1">
	<div class="row">
		<div class="col">
		{% if filter_approval == 'new' %}
			<span class="badge badge-success">новые</span>
		{% else %}
			<a href="{{ url_for('main.ShowIndex', from = filter_from, approval = 'new', location = filter_location) }}" class="badge badge-primary">новые</a>
		{% endif %}
		{% if filter_approval == 'partly_approved' %}
			<span class="badge badge-success">в работе</span>
		{% else %}
			<a href="{{ url_for('main.ShowIndex', from = filter_from, approval = 'partly_approved', location = filter_location) }}" class="badge badge-primary">в работе</a>
		{% endif %}
		{% if filter_approval == 'approved' %}
			<span class="badge badge-success">согласованные</span>
		{% else %}
			<a href="{{ url_for('main.ShowIndex', from = filter_from, approval = 'approved', location = filter_location) }}" class="badge badge-primary">согласованные</a>
		{% endif %}
		{% if filter_approval == 'not_approved' %}
			<span class="badge badge-success">не согласованные</span>
		{% else %}
			<a href="{{ url_for('main.ShowIndex', from = filter_from, approval = 'not_approved', location = filter_location) }}" class="badge badge-primary">не согласованные</a>
		{% endif %}
		{% if filter_approval == None %}
			<span class="badge badge-success">все</span>
		{% else %}
			<a href="{{ url_for('main.ShowIndex', from = filter_from, location = filter_location) }}" class="badge badge-primary">все</a>
		{% endif %}
		</div>
	</div>
	<div class="row">
		<div class="col">
			{% if filter_from == dates[0] %}
				<span class="badge badge-success">сегодня</span>
			{% else %}
				<a href="{{ url_for('main.ShowIndex', from = dates[0], approval = filter_approval, location = filter_location) }}" class="badge badge-primary">сегодня</a>
			{% endif %}
			{% if filter_from == dates[1] %}
				<span class="badge badge-success">неделя</span>
			{% else %}
				<a href="{{ url_for('main.ShowIndex', from = dates[1], approval = filter_approval, location = filter_location) }}" class="badge badge-primary">неделя</a>
			{% endif %}
			{% if filter_from == dates[2] %}
				<span class="badge badge-success">месяц</span>
			{% else %}
				<a href="{{ url_for('main.ShowIndex', from = dates[2], approval = filter_approval, location = filter_location) }}" class="badge badge-primary">месяц</a>
			{% endif %}
			{% if filter_from == None %}
				<span class="badge badge-success">все</span>
			{% else %}
				<a href="{{ url_for('main.ShowIndex', approval = filter_approval, location = filter_location) }}" class="badge badge-primary">все</a>
			{% endif %}
		</div>
	</div>
	{% if current_user.role.name != 'initiative' %}
		<div class="row">
			<div class="col">
				{% for initiative in initiatives %}
					<a href="{{ url_for('main.ShowIndex', approval = filter_approval, from = filter_from, location = initiative) }}" class="badge badge-primary">{{ initiatives[initiative] }}</a>
				{% endfor %}
					<a href="{{ url_for('main.ShowIndex', approval = filter_approval, from = filter_from) }}" class="badge badge-primary">все</a>
			</div>
		</div>
	{% endif %}
</div>
<div class="container border bg-light my-1">
	<h6 class="text-secondary text-right">Заявки</h6>
	<div class="row my-1 d-none d-sm-flex font-weight-bold">
		<div class="col overflow-hidden">
			Номер
		</div>
		<div class="col overflow-hidden">
			Дата
		</div>
		<div class="col overflow-hidden">
			Инициатор
		</div>
		<div class="col overflow-hidden">
			Сумма
		</div>
		<div class="col overflow-hidden">
			Согласование
		</div>
	</div>
	{% for order in orders %}
		{% include '_order.html' %}
	{% endfor %}
</div>
{% endblock %}

{% block scripts %}

<script>
	$(document).ready(function(){
		//Scripts
		
		$(".ecwidOrder").click(function(event){
			var orderId = Number($(this).attr('id').replace('order', ''));
			if (!isNaN(orderId))
				document.location.href = '/order/' + orderId;
		});
	});
</script>
{%endblock %}